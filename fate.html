<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Terminal Hacker - Convite para Mesa Fate</title>
<style>
  * {margin:0; padding:0; box-sizing:border-box;}
  body {
    background: black;
    color: #33ff99;
    font-family: 'Courier New', monospace;
    overflow: hidden;
    height: 100vh;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    padding: 10px;
    background-image: radial-gradient(circle, rgba(51,255,153,0.1) 1px, transparent 1px);
    background-size: 20px 20px;
    position: relative;
  }

  /* Efeito hacker: códigos binários caindo */
  .matrix-rain {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    overflow: hidden;
    z-index: -1;
  }
  .matrix-rain span {
    position: absolute;
    color: #33ff99;
    font-size: 12px;
    opacity: 0.8;
    animation: fall 5s linear infinite;
  }
  @keyframes fall {
    0% { transform: translateY(-100vh); }
    100% { transform: translateY(100vh); }
  }

  #terminal {
    width: 95%;
    max-width: 900px;
    height: 80%;
    background: rgba(0,0,0,0.9);
    border: 2px solid #33ff99;
    padding: 15px;
    overflow-y: auto;
    box-shadow: 0 0 30px #33ff99, inset 0 0 20px rgba(51,255,153,0.2);
    position: relative;
    white-space: pre-wrap;
    font-size: 14px;
    line-height: 1.4;
  }

  /* Media queries */
  @media (max-width: 768px) {
    #terminal { height: 70%; padding: 10px; font-size: 12px; }
    .option { padding: 8px 12px; font-size: 12px; }
    #inputField { font-size: 12px; }
  }

  .cursor {
    display: inline-block;
    width: 10px;
    height: 1.2em;
    background-color: #33ff99;
    margin-left:2px;
    animation: blink 1s step-end infinite;
  }
  @keyframes blink { 50% { background: transparent; } }

  .option, #inputField {
    display: block;
    margin: 5px 0;
    color: #33ff99;
    background: rgba(0,0,0,0.5);
    border: 1px solid #33ff99;
    padding: 5px 10px;
    cursor: pointer;
    width: fit-content;
    max-width: 100%;
    word-wrap: break-word;
    transition: all 0.3s ease;
  }
  .option:hover { background: #33ff99; color: black; transform: scale(1.05); }
  #inputField { width: 100%; max-width: 400px; }

  #startBtn { display: none; margin-top: 10px; padding: 10px 20px; background: #33ff99; color: black; border: none; cursor: pointer; }
  #startBtn:hover { background: #00ff66; }
</style>
</head>
<body>
<div class="matrix-rain" id="matrixRain"></div>
<div id="terminal"></div>
<div class="button-container" style="display: none;">
  <button id="startBtn">[PRESS ENTER TO BEGIN YOUR FATE]</button>
</div>

<script>
const terminal = document.getElementById("terminal");
const matrixRain = document.getElementById("matrixRain");
let playerProfile = { nome: "", perfil: "", natureza: "", motivacao: "" };
let audioEnabled = true;
const typingSound = new Audio("https://www.soundjay.com/misc/sounds/typewriter-1.wav");
typingSound.volume = 0.05;

// Efeito hacker: códigos binários caindo
function createMatrixRain() {
  for (let i = 0; i < 50; i++) {
    const span = document.createElement("span");
    span.innerText = Math.random() > 0.5 ? "1" : "0";
    span.style.left = Math.random() * 100 + "%";
    span.style.animationDelay = Math.random() * 5 + "s";
    matrixRain.appendChild(span);
  }
}
createMatrixRain();

// Árvore de diálogo reorganizada: Começa com nome, depois perguntas antigas, final com análise
const dialogueTree = [
  {
    text: "Transmissão interceptada... Se você está lendo esta mensagem, é porque o chamado chegou até você. Há séculos, o mundo tem sido palco de uma guerra invisível — travada nas sombras, onde magia e mito ainda respiram. Mas antes que eu possa revelar mais, preciso confirmar quem está do outro lado desta linha. Qual é o seu nome, candidato?",
    input: true,
    next: 1
  },
  {
    text: `Processando... Agora, ${playerProfile.nome}, preciso compreender quem você é neste mundo. Você é um estudante, ou um adulto?`,
    options: [
      { text: "Estudante", next: 2, response: "A juventude é o terreno fértil onde o destino costuma plantar suas tragédias. Jovens magos — ou curiosos — já causaram catástrofes ao tocarem o que não deveriam. Talvez ainda haja tempo de recuar… mas duvido que queira." },
      { text: "Adulto", next: 2, response: "Você já fez escolhas demais para voltar atrás. Experiência, perdas, e segredos — são os instrumentos dos veteranos. E também as correntes que os prendem ao passado." }
    ]
  },
  {
    text: `Última verificação de registro astral, ${playerProfile.nome}. Você é um Mago, ou apenas um humano comum?`,
    options: [
      { text: "Sou um Mago", next: 3, response: "Então compreende o peso de um juramento mágico. A Guerra do Santo Graal é o ápice de toda disputa arcana — onde linhagens inteiras se extinguem por um único desejo." },
      { text: "Sou uma pessoa comum", next: 3, response: "Interessante. Mesmo os não iniciados às vezes são escolhidos. O Cálice reconhece o potencial do espírito humano… e o corrompe com promessas que poucos resistem." }
    ]
  },
  {
    text: `Diga-me, ${playerProfile.nome}… o que sabe sobre a Guerra do Santo Graal?`,
    options: [
      { text: "Já ouvi falar", next: 4, response: "A Guerra do Santo Graal é um ritual secreto travado entre sete magos chamados Mestres. Cada Mestre invoca um Espírito Heróico, um Servo de eras passadas. Classes dos Servos: Saber — nobre e honrado. Archer — atirador preciso. Lancer — ágil e letal. Rider — portador de montarias divinas. Caster — mago supremo. Assassin — invisível e mortal. Berserker — poder absoluto à custa da sanidade. O Cálice concede qualquer desejo, mas sempre cobra seu preço." },
      { text: "Não muito", next: 4, response: "Sete magos, sete Servos. Cada par luta por um único desejo concedido pelo Cálice. Uma guerra de milagres e sacrifícios." },
      { text: "Quero entender melhor", next: 4, response: "O Santo Graal é uma relíquia que realiza desejos. Mas cada Guerra deixa cicatrizes: mortes, destruição, e distorções na realidade. O preço é sempre proporcional ao desejo." }
    ]
  },
  {
    text: `Se você estivesse diante do Cálice, ${playerProfile.nome}, o que pediria?`,
    options: [
      { text: "Salvar alguém que perdi", next: 5, response: "Um desejo nobre… perigoso, mas compreensível." },
      { text: "Conhecimento absoluto", next: 5, response: "Todo desejo carrega uma sombra. Espero que saiba o preço." },
      { text: "Equilíbrio e justiça", next: 5, response: "Todo desejo carrega uma sombra. Espero que saiba o preço." },
      { text: "Poder e controle", next: 5, response: "Todo desejo carrega uma sombra. Espero que saiba o preço." },
      { text: "Mudar o mundo", next: 5, response: "Todo desejo carrega uma sombra. Espero que saiba o preço." },
      { text: "Nada… alguns desejos não devem ser realizados", next: 5, response: "Todo desejo carrega uma sombra. Espero que saiba o preço." }
    ]
  },
  {
    text: "Processando suas respostas...",
    options: [
      { text: "Finalizar análise", next: null }
    ]
  }
];

// Typewriter
function typeWriter(text, i = 0, callback) {
  if (i < text.length) {
    terminal.innerHTML += text.charAt(i);
    if (audioEnabled) {
      typingSound.currentTime = 0;
      typingSound.play();
    }
    i++;
    setTimeout(() => typeWriter(text, i, callback), 30);
    terminal.scrollTop = terminal.scrollHeight;
  } else if (callback) callback();
}

// Render options or input
function renderInteraction(node) {
  if (node.input) {
    const input = document.createElement("input");
    input.id = "inputField";
    input.placeholder = "Digite seu nome...";
    input.addEventListener("keypress", (e) => {
      if (e.key === "Enter") {
        playerProfile.nome = input.value || "Anônimo";
        terminal.innerHTML += "\n> " + playerProfile.nome + "\n\n";
        input.remove();
        startDialogue(node.next);
      }
    });
    terminal.appendChild(input);
  } else if (node.options) {
    node.options.forEach(opt => {
      const btn = document.createElement("div");
      btn.classList.add("option");
      btn.innerText = opt.text;
      btn.addEventListener("click", () => {
        terminal.innerHTML += "\n> " + opt.text + "\n\n";
        if (opt.response) {
          playerProfile.perfil = opt.text === "Estudante" || opt.text === "Adulto" ? opt.text : playerProfile.perfil;
          playerProfile.natureza = opt.text === "Sou um Mago" || opt.text === "Sou uma pessoa comum" ? opt.text : playerProfile.natureza;
          playerProfile.motivacao = opt.response.includes("Um desejo nobre") ? opt.text : playerProfile.motivacao;
          typeWriter(opt.response + "\n\n", 0, () => {
            Array.from(document.getElementsByClassName("option")).forEach(b => b.remove());
            startDialogue(opt.next);
          });
        } else {
          Array.from(document.getElementsByClassName("option")).forEach(b => b.remove());
          if (opt.next === null) {
            // Análise final
            const codigo = "FG-" + Math.random().toString(36).substr(2, 6).toUpperCase();
            const analise = `
Análise completa de ${playerProfile.nome}.
Perfil: ${playerProfile.perfil}
Natureza: ${playerProfile.natureza}
Motivação: ${playerProfile.motivacao}

Você foi avaliado. Seu código de transmissão: ${codigo}. Use-o para prosseguir na Guerra.
Transmissão encerrada.
            `;
            typeWriter(analise);
          } else {
            startDialogue(opt.next);
          }
        }
      });
      terminal.appendChild(btn);
    });
  }
}

// Start dialogue
function startDialogue(index) {
  if (index === null) return;
  const node = dialogueTree[index];
  typeWriter(node.text + "\n\n", 0, () => {
    if (node.end) {
      // Final
    } else {
      renderInteraction(node);
    }
  });
}

// Inicia
startDialogue(0);
</script>
</body>
</html>
